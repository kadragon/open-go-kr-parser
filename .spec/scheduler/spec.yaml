spec_id: SPEC-scheduler-001
title: "GitHub Actions Daily Scheduler"
description: |
  Automated workflow that runs daily to fetch and notify
  about new government document disclosures.

given_when_then:
  - given: "Scheduled time (09:00 KST) arrives"
    when: "GitHub Actions triggers workflow"
    then: "Fetches yesterday's documents for all configured agencies"

  - given: "Workflow runs successfully"
    when: "Documents are found"
    then: "Sends Telegram notification for each agency"

  - given: "API request fails for one agency"
    when: "Workflow processes multiple agencies"
    then: "Continues with other agencies and logs error"

  - given: "Manual workflow dispatch"
    when: "User triggers with custom date"
    then: "Fetches documents for specified date"

acceptance_tests:
  - id: TEST-scheduler-001
    desc: "Workflow triggers at scheduled time"
  - id: TEST-scheduler-002
    desc: "Processes all agencies in config"
  - id: TEST-scheduler-003
    desc: "Handles partial failures gracefully"
  - id: TEST-scheduler-004
    desc: "Manual dispatch with custom date works"

workflow_config:
  schedule: "0 0 * * *"  # 00:00 UTC = 09:00 KST
  runner: ubuntu-latest
  python_version: "3.11"

  secrets_required:
    - TELEGRAM_BOT_TOKEN
    - TELEGRAM_CHAT_ID

  inputs:
    target_date:
      description: "Date to fetch (YYYY-MM-DD), defaults to yesterday"
      required: false

dependencies:
  - spec: api-client
  - spec: telegram-notifier
  - governance: env

linked_tasks: []
